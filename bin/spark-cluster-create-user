#!/usr/bin/env python

from dtde import clusterlib, util, azure_api
import argparse
import os

if __name__ == '__main__':

    pool_id = None
    username = 'admin'
    password = 'pass123!'

    # parse arguments
    parser = argparse.ArgumentParser(prog='az_spark')

    parser.add_argument('--id', dest='cluster_id', required=True,
                        help='The unique id of your spark cluster')
    parser.add_argument('-u', '--username', 
                        help='The usernameto access your spark cluster\'s head node')
    parser.add_argument('-p', '--password', 
                        help='The password to access your spark cluster\'s head node')

    args = parser.parse_args()
    
    if args.cluster_id is not None:
        pool_id = args.cluster_id

    if args.username is not None:
        username = args.username

    if args.password is not None:
        password = args.password

    print('-------------------------------------------')
    print('spark cluster id:    {}'.format(pool_id))
    print('username:            {}'.format(username))
    print('password:            {}'.format(password))
    print('-------------------------------------------')

    # get ssh command
    clusterlib.create_user(
        pool_id,
        username,
        password)
    
